scriptdir = CreateObject("Scripting.FileSystemObject").GetParentFolderName(WScript.ScriptFullName)

' Display all messages
Dim x
x=0
Do While x<18
x=x+1
msgName = scriptdir & "\messages\" & x & ".HTA"

Set WshShell = WScript.CreateObject("WScript.Shell")
statusCode = WshShell.Run(msgName, 1, false)
Loop
' 10 seconds timeout
startTime1 = Now
endTime1 = DateAdd("S",5,startTime1)
Do Until Now >= endTime1
Loop

' Freez mouse for 32 seconds
freezName = "powershell -file " & scriptdir & "\freeze.ps1"
Set mouse = CreateObject("WScript.Shell").Exec(freezName)

startTime = Now
' Start the video
batName = "cmd /c " & scriptdir & "\video.bat"
statusCode = WshShell.Run(batName, 0, true)

' Start the hacker video
hackerBatName = "cmd /c " & scriptdir & "\hackerVideo.bat"
statusCode = WshShell.Run(hackerBatName, 0, false)

endTime = DateAdd("S",45,startTime)
Do Until Now >= endTime
Loop
mouse.Terminate

' Start the hacker video
tabsBat = "cmd /c " & scriptdir & "\closeTabs.bat"
statusCode = WshShell.Run(tabsBat, 0, false)

' 10 seconds timeout
startTime2 = Now
endTime2 = DateAdd("S",10,startTime2)
Do Until Now >= endTime2
Loop

exeName = scriptdir & "\lib\GooseDesktop.exe"
statusCode = WshShell.Run(exeName, 1, false)
' 5 seconds timeout
startTime2 = Now
endTime2 = DateAdd("S",3,startTime2)
Do Until Now >= endTime2
Loop
statusCode = WshShell.Run(exeName, 1, false)
' 5 seconds timeout
startTime2 = Now
endTime2 = DateAdd("S",2,startTime2)
Do Until Now >= endTime2
Loop
statusCode = WshShell.Run(exeName, 1, false)

startTime2 = Now
endTime2 = DateAdd("S",8,startTime2)
Do Until Now >= endTime2
Loop
msgName = scriptdir & "\messages\warn.HTA"

Set WshShell = WScript.CreateObject("WScript.Shell")
statusCode = WshShell.Run(msgName, 1, false)
statusCode = WshShell.Run("powershell New-BurntToastNotification -AppLogo " & scriptdir &"\warning.png -Text 'Warning','Malware has been detected on your computer.'", 0, false)

scriptdir = CreateObject("Scripting.FileSystemObject").GetParentFolderName(WScript.ScriptFullName)

' Display all messages
Dim x
x=0
Do While x<18
x=x+1
msgName = scriptdir & "\messages\" & x & ".HTA"

Set WshShell = WScript.CreateObject("WScript.Shell")
statusCode = WshShell.Run(msgName, 1, false)
Loop
' 10 seconds timeout
startTime1 = Now
endTime1 = DateAdd("S",5,startTime1)
Do Until Now >= endTime1
Loop

Set WshShell = WScript.CreateObject("WScript.Shell")

' Freez mouse for 32 seconds
freezName = "powershell -file " & scriptdir & "\freeze.ps1"
Set mouse = CreateObject("WScript.Shell").Exec(freezName)

startTime = Now
' Start the video
batName = scriptdir & "\video.bat"
statusCode = WshShell.Run(batName, 1, false)

endTime = DateAdd("S",32,startTime)
Do Until Now >= endTime
Loop
mouse.Terminate

' 20 seconds timeout
startTime2 = Now
endTime2 = DateAdd("S",20,startTime2)
Do Until Now >= endTime2
Loop

exeName = scriptdir & "\lib\GooseDesktop.exe"
statusCode = WshShell.Run(exeName, 1, false)
' 5 seconds timeout
startTime2 = Now
endTime2 = DateAdd("S",5,startTime2)
Do Until Now >= endTime2
Loop
statusCode = WshShell.Run(exeName, 1, false)
' 5 seconds timeout
startTime2 = Now
endTime2 = DateAdd("S",5,startTime2)
Do Until Now >= endTime2
Loop
statusCode = WshShell.Run(exeName, 1, false)
